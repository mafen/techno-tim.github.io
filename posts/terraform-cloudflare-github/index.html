<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Automate Cloudflare with Terraform and GitHub Actions! - Terraform Tutorial for Beginners" /><meta property="og:locale" content="en" /><meta name="description" content="Today, we’re going to set up and configure Terraform on your machine so we can start using Terraform. Then we’ll configure cf-terraforming to import our Cloudflare state and configuration into Terraform. After that we’ll set up a GitHub report and configure GitHub actions so you have CI and CD for deploying your Infrastructure automatically using a Git Flow. If you’re new to Terraform, that’s fine! This is a beginner tutorial for Terraform and by the end of this, you will feel like an expert!" /><meta property="og:description" content="Today, we’re going to set up and configure Terraform on your machine so we can start using Terraform. Then we’ll configure cf-terraforming to import our Cloudflare state and configuration into Terraform. After that we’ll set up a GitHub report and configure GitHub actions so you have CI and CD for deploying your Infrastructure automatically using a Git Flow. If you’re new to Terraform, that’s fine! This is a beginner tutorial for Terraform and by the end of this, you will feel like an expert!" /><link rel="canonical" href="https://docs.technotim.live/posts/terraform-cloudflare-github/" /><meta property="og:url" content="https://docs.technotim.live/posts/terraform-cloudflare-github/" /><meta property="og:site_name" content="Techno Tim Documentation" /><meta property="og:image" content="https://docs.technotim.live/assets/img/headers/terraform-mars.jpg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-03-25T10:00:00-05:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://docs.technotim.live/assets/img/headers/terraform-mars.jpg" /><meta property="twitter:title" content="Automate Cloudflare with Terraform and GitHub Actions! - Terraform Tutorial for Beginners" /><meta name="twitter:site" content="@technotimlive" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-04-06T20:19:14-05:00","datePublished":"2023-03-25T10:00:00-05:00","description":"Today, we’re going to set up and configure Terraform on your machine so we can start using Terraform. Then we’ll configure cf-terraforming to import our Cloudflare state and configuration into Terraform. After that we’ll set up a GitHub report and configure GitHub actions so you have CI and CD for deploying your Infrastructure automatically using a Git Flow. If you’re new to Terraform, that’s fine! This is a beginner tutorial for Terraform and by the end of this, you will feel like an expert!","headline":"Automate Cloudflare with Terraform and GitHub Actions! - Terraform Tutorial for Beginners","image":"https://docs.technotim.live/assets/img/headers/terraform-mars.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://docs.technotim.live/posts/terraform-cloudflare-github/"},"url":"https://docs.technotim.live/posts/terraform-cloudflare-github/"}</script><title>Automate Cloudflare with Terraform and GitHub Actions! - Terraform Tutorial for Beginners | Techno Tim Documentation</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Techno Tim Documentation"><meta name="application-name" content="Techno Tim Documentation"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/1322205?s=400&u=5b4f2219006577dc0426007fe5a02391c4899677&v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Techno Tim Documentation</a></div><div class="site-subtitle font-italic">Video documentation for all your copy pasta needs!</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://twitter.com/technotimlive" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> </a> <a href="https://l.technotim.live/subscribe" aria-label="youtube" target="_blank" rel="noopener noreferrer"> <i class="fab fa-youtube"></i> </a> <a href="https://github.com/timothystewart6" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://l.technotim.live/patreon" aria-label="patreon" target="_blank" rel="noopener noreferrer"> <i class="fab fa-patreon"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Automate Cloudflare with Terraform and GitHub Actions! - Terraform Tutorial for Beginners</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Automate Cloudflare with Terraform and GitHub Actions! - Terraform Tutorial for Beginners</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1679756400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 25, 2023 </em> </span> <span> Updated <em class="" data-ts="1680830354" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 6, 2023 </em> </span><div class="mt-3 mb-3"> <a href="/assets/img/headers/terraform-mars.jpg" class="popup img-link preview-img shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 630'%3E%3C/svg%3E" data-src="/assets/img/headers/terraform-mars.jpg" alt="Preview Image" width="1200" height="630" class="lazyload" data-proofer-ignore></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://l.technotim.live/twitter">Techno Tim</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1646 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><p>Today, we’re going to set up and configure Terraform on your machine so we can start using Terraform. Then we’ll configure <code class="language-plaintext highlighter-rouge">cf-terraforming</code> to import our Cloudflare state and configuration into Terraform. After that we’ll set up a GitHub report and configure GitHub actions so you have CI and CD for deploying your Infrastructure automatically using a Git Flow. If you’re new to Terraform, that’s fine! This is a beginner tutorial for Terraform and by the end of this, you will feel like an expert!</p><iframe class="embed-video youtube lazyload" src="https://www.youtube.com/embed/FmYvrxYvBP0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><p>📺 <a href="https://www.youtube.com/watch?v=FmYvrxYvBP0">Watch Video</a></p><h2 id="what-is-terraform-and-how-does-it-help"><span class="mr-2">What is Terraform and how does it help?</span><a href="#what-is-terraform-and-how-does-it-help" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Terraform is a powerful infrastructure as code tool to help you create and manage infrastructure across multiple public or private clouds. It can help you provision, configure, and manage infrastructure using their simple and human readable configuration language. Using Terraform helps you automate your infrastructure and your DevOps workflow, do it consistently, and allows you to collaborate with teams in Git.</p><p>There are 7 key areas where Terraform shines:</p><ul><li><p>Automation: Terraform enables automation of infrastructure provisioning, configuration, and management, which reduces human error and saves time.</p><li><p>Consistency: Terraform ensures that your infrastructure is consistent across all environments, from development to production.</p><li><p>Collaboration: Terraform allows multiple teams to work together on infrastructure changes, using version control systems like Git.</p><li><p>Cloud-agnostic: Terraform supports various cloud providers, including AWS, Google Cloud, and Microsoft Azure, allowing you to use the same tool to manage resources across different clouds.</p><li><p>Scalability: Terraform is designed to handle large-scale infrastructure deployments and can easily manage thousands of resources.</p><li><p>Reusability: Terraform modules enable you to reuse code and infrastructure components across multiple projects, making it easier to manage infrastructure at scale.</p><li><p>Flexibility: Terraform is highly flexible and can be extended through plugins to integrate with other tools and services.</p></ul><h2 id="installing-terraform"><span class="mr-2">Installing Terraform</span><a href="#installing-terraform" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This will work on Ubuntu and Windows + WSL</p><p><a href="https://developer.hashicorp.com/terraform/tutorials/aws-get-started/install-cli">Install <code class="language-plaintext highlighter-rouge">terraform</code> for other platforms</a></p><p>Install dependencies</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt update
<span class="nb">sudo </span>apt <span class="nb">install  </span>software-properties-common gnupg2 curl
</pre></table></code></div></div><p>Import the gpg key</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>curl https://apt.releases.hashicorp.com/gpg | gpg <span class="nt">--dearmor</span> <span class="o">&gt;</span> hashicorp.gpg
<span class="nb">sudo install</span> <span class="nt">-o</span> root <span class="nt">-g</span> root <span class="nt">-m</span> 644 hashicorp.gpg /etc/apt/trusted.gpg.d/
</pre></table></code></div></div><p>Add hashicorp repository</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt-add-repository <span class="s2">"deb [arch=</span><span class="si">$(</span>dpkg <span class="nt">--print-architecture</span><span class="si">)</span><span class="s2">] https://apt.releases.hashicorp.com </span><span class="si">$(</span>lsb_release <span class="nt">-cs</span><span class="si">)</span><span class="s2"> main"</span>
</pre></table></code></div></div><p>Install <code class="language-plaintext highlighter-rouge">terraform</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt <span class="nb">install </span>terraform
</pre></table></code></div></div><p>Check the version</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>terraform <span class="nt">--version</span>
Terraform v1.4.0
on linux_amd64
</pre></table></code></div></div><h2 id="create-your-terraform-cloudflare-config"><span class="mr-2">Create your Terraform Cloudflare config</span><a href="#create-your-terraform-cloudflare-config" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>First create a simple terraform config:</p><div file="cloudflare.tf" class="language-hcl highlighter-rouge"><div class="code-header"> <span data-label-text="cloudflare.tf"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="nx">terraform</span> <span class="p">{</span>
  <span class="nx">required_providers</span> <span class="p">{</span>
    <span class="nx">cloudflare</span> <span class="p">=</span> <span class="p">{</span>
      <span class="nx">source</span>  <span class="p">=</span> <span class="s2">"cloudflare/cloudflare"</span>
      <span class="nx">version</span> <span class="p">=</span> <span class="s2">"~&gt; 3.0"</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">provider</span> <span class="s2">"cloudflare"</span> <span class="p">{</span>
  <span class="nx">api_token</span> <span class="p">=</span> <span class="nx">var</span><span class="err">.</span><span class="nx">cloudflare_api_token</span>
<span class="p">}</span>

<span class="c1"># Create a record</span>
<span class="nx">resource</span> <span class="s2">"cloudflare_record"</span> <span class="s2">"www"</span> <span class="p">{</span>
  <span class="c1"># ...</span>
<span class="p">}</span>

<span class="c1"># Create a page rule</span>
<span class="nx">resource</span> <span class="s2">"cloudflare_page_rule"</span> <span class="s2">"www"</span> <span class="p">{</span>
  <span class="c1"># ...</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Here is my <code class="language-plaintext highlighter-rouge">.editorconfig</code>:</p><div file=".editorconfig" class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text=".editorconfig"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="c"># http://editorconfig.org</span>
root <span class="o">=</span> <span class="nb">true</span>

<span class="o">[</span><span class="k">*</span><span class="o">]</span>
indent_style <span class="o">=</span> space
indent_size <span class="o">=</span> 2
charset <span class="o">=</span> utf-8
trim_trailing_whitespace <span class="o">=</span> <span class="nb">true
</span>insert_final_newline <span class="o">=</span> <span class="nb">true</span>

<span class="o">[</span><span class="k">*</span>.md]
trim_trailing_whitespace <span class="o">=</span> <span class="nb">false</span>
</pre></table></code></div></div><p>Initialize terraform and Cloudflare</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>terraform init
</pre></table></code></div></div><p>We should see that it installed plugins, and it should have created a lock file.</p><h2 id="terraform-plan-and-apply"><span class="mr-2">Terraform Plan and Apply</span><a href="#terraform-plan-and-apply" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Next we’ll want to review our plan, we can see our proposed changes</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>terraform plan
</pre></table></code></div></div><p>Next we’ll apply our changes.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>terraform apply
</pre></table></code></div></div><p>Verify on the dashboard.</p><p>After applying we can verify the results.</p><p>we can also test with <code class="language-plaintext highlighter-rouge">nslookup</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nslookup yoursite.example.com
</pre></table></code></div></div><p>Check Cloudflare’s site.</p><p>if we run plan again, we can see there’s no work to do</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>terraform apply
</pre></table></code></div></div><p>Should see that there isn’t any work to do.</p><h2 id="importing-cloudflare-state"><span class="mr-2">Importing Cloudflare State</span><a href="#importing-cloudflare-state" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We will need to import our Cloudflare state into our local Terraform state.</p><blockquote><p>An important point to understand about Terraform is that it can only manage configuration it created or was explicitly told about after the fact. The reason for this limitation is that Terraform expects to be authoritative for the resources it manages. It relies on two types of files to understand what resources it controls and what state they are in. Terraform determines when and how to make changes from the following:</p><ul><li>A configuration file (ending in .tf) that defines the configuration of resources for Terraform to manage. This is what you worked with in the tutorial steps.<li>A local state file that maps the resource names defined in your configuration file — for example, cloudflare_load_balancer.www-lb — to the resources that exist in Cloudflare.</ul></blockquote><p><a href="https://developers.cloudflare.com/terraform/advanced-topics/import-cloudflare-resources/">https://developers.cloudflare.com/terraform/advanced-topics/import-cloudflare-resources/</a></p><p>So this means that we need to sync the remote state of Cloudflare, down to our local state.</p><p>This is where <code class="language-plaintext highlighter-rouge">cf-terraforming</code> can help</p><p>Check for the latest version here: <a href="https://github.com/cloudflare/cf-terraforming/tags">https://github.com/cloudflare/cf-terraforming/tags</a></p><p>Update this command with the latest tag</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>curl <span class="nt">-L</span> https://github.com/cloudflare/cf-terraforming/releases/download/v0.11.0/cf-terraforming_0.11.0_linux_amd64.tar.gz <span class="nt">-o</span> cf-terraforming.tar.gz

<span class="nb">tar</span> <span class="nt">-xzf</span> cf-terraforming.tar.gz

<span class="nb">rm </span>cf-terraforming.tar.gz

<span class="nb">sudo mv</span> ./cf-terraforming /usr/local/bin

<span class="nb">sudo chmod</span> +x /usr/local/bin/cf-terraforming
</pre></table></code></div></div><p>Then we need to updated our <code class="language-plaintext highlighter-rouge">.zshrc</code> or <code class="language-plaintext highlighter-rouge">.bashrc</code> with our variables</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nano ~/.zshrc
</pre></table></code></div></div><div file="~/.zshrc" class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="~/.zshrc"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">CLOUDFLARE_API_TOKEN</span><span class="o">=</span><span class="s1">'12345'</span>
<span class="nb">export </span><span class="nv">CLOUDFLARE_ZONE_ID</span><span class="o">=</span><span class="s1">'abcde'</span>
</pre></table></code></div></div><p>The source your shell</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">source</span> ~/.zshrc
</pre></table></code></div></div><p>Now let’s export Cloudflare state</p><p>(Be sure you have copied your variables into your shell, or ran the export commands above )</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>cf-terraforming generate <span class="se">\</span>
  <span class="nt">--resource-type</span> <span class="s2">"cloudflare_record"</span> <span class="se">\</span>
  <span class="nt">--zone</span> <span class="nv">$CLOUDFLARE_ZONE_ID</span> <span class="o">&gt;</span> imported.tf
</pre></table></code></div></div><p>Look at the file and copy the contents into your <code class="language-plaintext highlighter-rouge">cloudflare.tf</code></p><p>then run</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>terraform plan
</pre></table></code></div></div><p>Terraform thinks that we need to apply all of these resources, even though they exist.</p><p>We need to import them into our local state.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>cf-terraforming import <span class="se">\</span>
  <span class="nt">--resource-type</span> <span class="s2">"cloudflare_record"</span> <span class="se">\</span>
  <span class="nt">--zone</span> <span class="nv">$CLOUDFLARE_ZONE_ID</span>
</pre></table></code></div></div><p>This will export a lot of commands, we now need to run them to import them into our state.</p><p>All you need to do it copy and paste the commands into your terminal.</p><p>This will import your local state, you can see it in <code class="language-plaintext highlighter-rouge">terraform.tfstate</code></p><p>If we run <code class="language-plaintext highlighter-rouge">terraform plan</code> now, we can see that there aren’t any changes.</p><h2 id="remote-state-with-terraform-cloud"><span class="mr-2">Remote State with Terraform Cloud</span><a href="#remote-state-with-terraform-cloud" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://app.terraform.io/">Terraform Cloud</a></p><p>Be sure to sign up for an account and then get add your <code class="language-plaintext highlighter-rouge">CLOUDFLARE_API_TOKEN</code> and an ENV variable in Terraform Cloud. Mark it as seneitive.</p><p>Then you’ll want to updated your <code class="language-plaintext highlighter-rouge">cloudflare.tf</code></p><p>It should look like this</p><div class="language-hcl highlighter-rouge"><div class="code-header"> <span data-label-text="Hcl"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>  <span class="nx">cloud</span> <span class="p">{</span>
    <span class="nx">hostname</span> <span class="p">=</span> <span class="s2">"app.terraform.io"</span>
    <span class="nx">organization</span> <span class="p">=</span> <span class="s2">"your org"</span>

    <span class="nx">workspaces</span> <span class="p">{</span>
      <span class="nx">name</span> <span class="p">=</span> <span class="s2">"Cloudflare"</span>
    <span class="p">}</span>
  <span class="p">}</span>
</pre></table></code></div></div><p>Your <code class="language-plaintext highlighter-rouge">cloudflare.tf</code> file should now look like:</p><div file="cloudflare.tf" class="language-hcl highlighter-rouge"><div class="code-header"> <span data-label-text="cloudflare.tf"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="nx">terraform</span> <span class="p">{</span>
  <span class="nx">cloud</span> <span class="p">{</span>
    <span class="nx">hostname</span> <span class="p">=</span> <span class="s2">"app.terraform.io"</span>
    <span class="nx">organization</span> <span class="p">=</span> <span class="s2">"your org"</span>

    <span class="nx">workspaces</span> <span class="p">{</span>
      <span class="nx">name</span> <span class="p">=</span> <span class="s2">"Cloudflare"</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nx">required_providers</span> <span class="p">{</span>
    <span class="nx">cloudflare</span> <span class="p">=</span> <span class="p">{</span>
      <span class="nx">source</span>  <span class="p">=</span> <span class="s2">"cloudflare/cloudflare"</span>
      <span class="nx">version</span> <span class="p">=</span> <span class="s2">"~&gt; 3.0"</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">provider</span> <span class="s2">"cloudflare"</span> <span class="p">{</span>
  <span class="nx">api_token</span> <span class="p">=</span> <span class="nx">var</span><span class="err">.</span><span class="nx">cloudflare_api_token</span>
<span class="p">}</span>

<span class="c1"># Create a record</span>
<span class="nx">resource</span> <span class="s2">"cloudflare_record"</span> <span class="s2">"www"</span> <span class="p">{</span>
  <span class="c1"># ...</span>
<span class="p">}</span>

<span class="c1"># Create a page rule</span>
<span class="nx">resource</span> <span class="s2">"cloudflare_page_rule"</span> <span class="s2">"www"</span> <span class="p">{</span>
  <span class="c1"># ...</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Then run</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>terraform init
</pre></table></code></div></div><p>This will prompt you to sign in and then import your local state into Terraform cloud.</p><h2 id="ci--cd-with-github-actions"><span class="mr-2">CI / CD with GitHub Actions</span><a href="#ci--cd-with-github-actions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>If you want to create a CI / CD pipeline with GitHub actions, you’ll need to create a new repo at <a href="https://github.com/">GitHub</a></p><p>Here is my <code class="language-plaintext highlighter-rouge">.gitignore</code></p><pre file=".gitignore"><code class="language-gitignore">.terraform/
terraform.tfstate*
</code></pre><p>Convert your local folder into a git repo:</p><p>first, <code class="language-plaintext highlighter-rouge">cd</code> into your folder</p><blockquote class="prompt-danger"><p><em>Note: Be sure not to commit any of your secrets to git! This includes API tokens, terraform state, and any other files that might include sensitive information</em></p></blockquote><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>git init
git commit <span class="nt">-m</span> <span class="s2">"first commit"</span>
git branch <span class="nt">-M</span> main
git remote add origin git@github.com:username/your-repo-name.git
git push <span class="nt">-u</span> origin main
</pre></table></code></div></div><p>To create a branch, add files, commit, and push</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>git checkout <span class="nt">-b</span> my-new-branch
git add <span class="nb">.</span>
git commit <span class="nt">-m</span> <span class="s2">"fix(terraform): made some changes"</span>
git push <span class="nt">--set-upstream</span> origin my-new-branch
</pre></table></code></div></div><p>Be sure you have created a secret <code class="language-plaintext highlighter-rouge">TF_API_TOKEN</code> with your Terraform API token.</p><p>For reference, here is the terraform GitHub Action (with my bug fix)</p><div file=".github/workflows/terraform.yml" class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text=".github/workflows/terraform.yml"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre><td class="rouge-code"><pre><span class="na">name</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Terraform'</span>

<span class="na">on</span><span class="pi">:</span>
  <span class="na">push</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span> <span class="pi">[</span> <span class="s2">"</span><span class="s">main"</span> <span class="pi">]</span>
  <span class="na">pull_request</span><span class="pi">:</span>

<span class="na">permissions</span><span class="pi">:</span>
  <span class="na">contents</span><span class="pi">:</span> <span class="s">read</span>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">terraform</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Terraform'</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">environment</span><span class="pi">:</span> <span class="s">production</span>

    <span class="c1"># Use the Bash shell regardless whether the GitHub Actions runner is ubuntu-latest, macos-latest, or windows-latest</span>
    <span class="na">defaults</span><span class="pi">:</span>
      <span class="na">run</span><span class="pi">:</span>
        <span class="na">shell</span><span class="pi">:</span> <span class="s">bash</span>

    <span class="na">steps</span><span class="pi">:</span>
    <span class="c1"># Checkout the repository to the GitHub Actions runner</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Checkout</span>
      <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v3</span>

    <span class="c1"># Install the latest version of Terraform CLI and configure the Terraform CLI configuration file with a Terraform Cloud user API token</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Setup Terraform</span>
      <span class="na">uses</span><span class="pi">:</span> <span class="s">hashicorp/setup-terraform@v2</span>
      <span class="na">with</span><span class="pi">:</span>
        <span class="na">cli_config_credentials_token</span><span class="pi">:</span> <span class="s">$</span>

    <span class="c1"># Initialize a new or existing Terraform working directory by creating initial files, loading any remote state, downloading modules, etc.</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Terraform Init</span>
      <span class="na">run</span><span class="pi">:</span> <span class="s">terraform init</span>

    <span class="c1"># Checks that all Terraform configuration files adhere to a canonical format</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Terraform Format</span>
      <span class="na">run</span><span class="pi">:</span> <span class="s">terraform fmt -check</span>

    <span class="c1"># Generates an execution plan for Terraform</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Terraform Plan</span>
      <span class="na">run</span><span class="pi">:</span> <span class="s">terraform plan -input=false</span>

      <span class="c1"># On push to "main", build or change infrastructure according to Terraform configuration files</span>
      <span class="c1"># Note: It is recommended to set up a required "strict" status check in your repository for "Terraform Cloud". See the documentation on "strict" required status checks for more information: https://help.github.com/en/github/administering-a-repository/types-of-required-status-checks</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Terraform Apply</span>
      <span class="na">if</span><span class="pi">:</span> <span class="s">github.ref == 'refs/heads/main' &amp;&amp; github.event_name == 'push'</span>
      <span class="na">run</span><span class="pi">:</span> <span class="s">terraform apply -auto-approve -input=false</span>
</pre></table></code></div></div><h2 id="wrapping-up"><span class="mr-2">Wrapping up</span><a href="#wrapping-up" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>At this point you should be able to run terraform and have your Cloudflare state sync’d with Terraform Cloud and GitHub actions running in CI / CD so you can start deploying your infrastructure using code!</p><h2 id="links"><span class="mr-2">Links</span><a href="#links" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>⚙️ See all the hardware I recommend at <a href="https://l.technotim.live/gear">https://l.technotim.live/gear</a></p><p>🚀 Don’t forget to check out the <a href="https://l.technotim.live/quick-start">🚀Launchpad repo</a> with all of the quick start source files</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/cloud/'>cloud</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/terraform/" class="post-tag no-text-decoration" >terraform</a> <a href="/tags/hashicorp/" class="post-tag no-text-decoration" >hashicorp</a> <a href="/tags/cloudflare/" class="post-tag no-text-decoration" >cloudflare</a> <a href="/tags/github/" class="post-tag no-text-decoration" >github</a> <a href="/tags/cloud/" class="post-tag no-text-decoration" >cloud</a> <a href="/tags/homelab/" class="post-tag no-text-decoration" >homelab</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Automate%20Cloudflare%20with%20Terraform%20and%20GitHub%20Actions!%20-%20Terraform%20Tutorial%20for%20Beginners%20-%20Techno%20Tim%20Documentation&url=https%3A%2F%2Fdocs.technotim.live%2Fposts%2Fterraform-cloudflare-github%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Automate%20Cloudflare%20with%20Terraform%20and%20GitHub%20Actions!%20-%20Terraform%20Tutorial%20for%20Beginners%20-%20Techno%20Tim%20Documentation&u=https%3A%2F%2Fdocs.technotim.live%2Fposts%2Fterraform-cloudflare-github%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fdocs.technotim.live%2Fposts%2Fterraform-cloudflare-github%2F&text=Automate%20Cloudflare%20with%20Terraform%20and%20GitHub%20Actions!%20-%20Terraform%20Tutorial%20for%20Beginners%20-%20Techno%20Tim%20Documentation" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fdocs.technotim.live%2Fposts%2Fterraform-cloudflare-github%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/low-power-efficient-server/">Building a Low Power, All-in-One, Silent Server</a><li><a href="/posts/terraform-cloudflare-github/">Automate Cloudflare with Terraform and GitHub Actions! - Terraform Tutorial for Beginners</a><li><a href="/posts/k3s-etcd-ansible/">Fully Automated K3S etcd High Availability Install</a><li><a href="/posts/uptime-kuma/">Meet Uptime Kuma, a Fancy Open Source Uptime Monitor for all your HomeLab Monitoring Needs</a><li><a href="/posts/first-11-things-proxmox/">Before I do anything on Proxmox, I do this first...</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/homelab/">homelab</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/rancher/">rancher</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/self-hosted/">self-hosted</a> <a class="post-tag" href="/tags/hardware/">hardware</a> <a class="post-tag" href="/tags/portainer/">portainer</a> <a class="post-tag" href="/tags/proxmox/">proxmox</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/k3s/">k3s</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/host-rancher-securely/"><div class="card-body"> <em class="small" data-ts="1599314400" data-df="ll" > Sep 5, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>SSL, Traefik, and OAuth for Rancher! (Google, GitHub, Keycloak, Azure, and more!)</h3><div class="text-muted small"><p> Do you want to self host your Rancher UI securely in your homelab? Have you thought about putting your Rancher UI behind Traefik and your reverse proxy to get free SSL certificates using Let’s Encr...</p></div></div></a></div><div class="card"> <a href="/posts/first-11-things-proxmox/"><div class="card-body"> <em class="small" data-ts="1606572000" data-df="ll" > Nov 28, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Before I do anything on Proxmox, I do this first...</h3><div class="text-muted small"><p> After setting up my Proxmox servers, there are a few things I do before I use them for their intended purpose. This ranges from updates, to storage, to networking and VLANS, to uploading ISOs, to ...</p></div></div></a></div><div class="card"> <a href="/posts/metal-as-a-service-packer/"><div class="card-body"> <em class="small" data-ts="1674914400" data-df="ll" > Jan 28, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Deploying Machines with MaaS and Packer - Metal as a Service + Hashicorp Packer Tutorial</h3><div class="text-muted small"><p> MaaS or Metal as a service from Canonical is a great way to provision bare metal machines as well as virtual machines. MaaS allows you to deploy Windows, Linux, ESXi, and many other operating syst...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/rotate-sops-encryption-keys/" class="btn btn-outline-primary" prompt="Older"><p>Rotating your Encryption Keys and Updating your Secrets with SOPS</p></a> <a href="/posts/low-power-efficient-server/" class="btn btn-outline-primary" prompt="Newer"><p>Building a Low Power, All-in-One, Silent Server</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "techno-tim/techno-tim.github.io", "data-repo-id": "MDEwOlJlcG9zaXRvcnkyNTQ3ODQ3Nzk", "data-category": "Comments", "data-category-id": "DIC_kwDODy-1C84CSN7z", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/homelab/">homelab</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/rancher/">rancher</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/self-hosted/">self-hosted</a> <a class="post-tag" href="/tags/hardware/">hardware</a> <a class="post-tag" href="/tags/portainer/">portainer</a> <a class="post-tag" href="/tags/proxmox/">proxmox</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/k3s/">k3s</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://l.technotim.live/twitter">Techno Tim</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">See something wrong? Want to contribute? <a href="https://github.com/techno-tim/techno-tim.github.io/tree/master/_posts">Edit this page 📝</href></p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available!</p><button type="button" class="btn btn-primary" aria-label="Update"> Update 🚀 </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1.11.6/dayjs.min.js,npm/dayjs@1.11.6/locale/en.min.js,npm/dayjs@1.11.6/plugin/relativeTime.min.js,npm/dayjs@1.11.6/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-NZ5V7DM8F5"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-NZ5V7DM8F5'); }); </script>
